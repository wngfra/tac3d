

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>9. Performance profiling &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10. Hard vs. soft membrane voltage reset" href="j_soft_reset_core.html" />
    <link rel="prev" title="8. Reward Trace" href="h_reward_trace.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nxnet_tutorials.html">NxNet Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a_compartment_setup.html">1. Compartment, CompartmentPrototype and Probes Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="b_connecting_compartments.html">2. Connecting compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="c_stimulating_compartments.html">3. Stimulating compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_synaptic_plasticity.html">4. Synaptic plasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="e_neuronal_homeostasis.html">5. Neuronal homeostasis</a></li>
<li class="toctree-l3"><a class="reference internal" href="f_rewards_learning.html">6. Learning with Rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_snip_for_threshold_modulation.html">7. SNIPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="h_reward_trace.html">8. Reward Trace</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">9. Performance profiling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.-SLURM-partition-selection">9.1. 1. SLURM partition selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.-Creating-a-minimal-network-with-execution-time-and-energy-probes">9.2. 2. Creating a minimal network with execution time and energy probes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#3.-Sample-workload">9.3. 3. Sample workload</a></li>
<li class="toctree-l4"><a class="reference internal" href="#4.-Basics-of-probing-and-execution-time">9.4. 4. Basics of probing and execution time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.-Power-and-Energy-Profiling">9.5. 5. Power and Energy Profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.1-Total-Power-Measurement">9.6. 5.1 Total Power Measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.4-Setting-up-a-Power-Test">9.7. 5.4 Setting up a Power Test</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.5-Components-of-Power-Consumption">9.8. 5.5 Components of Power Consumption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.6-Reported-Breakdown-of-Power">9.9. 5.6 Reported Breakdown of Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.7-Power-Report-Format">9.10. 5.7 Power Report Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#5.8-Power-to-Energy">9.11. 5.8 Power to Energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#6.-Workload-scaling">9.12. 6. Workload scaling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_core.html">10. Hard vs. soft membrane voltage reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_net.html">11. Soft reset membrane voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="k_interactive_spike_sender_receiver.html">12. Interactive Spike Sender and Spike Receivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="l_snip_for_compartment_setup_with_NxNet_C.html">13. Setup Compartments with NxNet C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="m_independent_networks_in_same_run.html">14. Independent Networks in Same Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html">15. Stochastic Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#C.-Puttin-It-All-Together">16. C. Puttin It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#Modify-createWtaMotif1-to-Include-Detector-Neuron">17. Modify createWtaMotif1 to Include Detector Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="o_snip_for_reading_lakemont_spike_count.html">18. Read Lakemont Spike Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="p_composable_networks.html">19. Composable Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="q_connection_sharing.html">20. Connection Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html">21. Stubs and NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html#NetModules">22. NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="s_multicx_neuron_self_reward.html">23. Implementation of a multi-compartment neuron with self-reward feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="t_vMinExp_and_vMaxExp.html">24. vMinExp and vMaxExp Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html">25. Neurons vs Compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html#Multi-compartment-neurons">26. Multi-compartment neurons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nxcore_tutorials.html">NxCore Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">9. </span>Performance profiling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># INTEL CORPORATION CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># Copyright © 2018-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="section" id="Performance-profiling">
<h1><span class="section-number">9. </span>Performance profiling<a class="headerlink" href="#Performance-profiling" title="Permalink to this headline">¶</a></h1>
<p>NxSDK offers performance profiling while executing a spiking neuron network and/or snips on one of the embedded CPUs. This allows to measure both execution time and power/energy consumption by Loihi in real-time. In order to support both, NxSDK provides ExecutionTime and EnergyProbes which are analogous to other state probes for membrane potential, spikes, etc.</p>
<p>EnergyProbes allow to measure both energy and execution time while ExecutionTimeProbes allow to only measure execution time. Energy is measured by the host CPU while the execution time is measured by one of the embedded Lakemont (LMT) CPUs which drives the time step advancement. Both energy and execution time series are acquired independently and asynchronously from each other. This means that the host acquires the power as a function of the host time <span class="math notranslate nohighlight">\(P(t_H)\)</span> while the embedded CPU
acquires the wall clock time as a function of algorithmic time step <span class="math notranslate nohighlight">\(t_{LMT}(t)\)</span> or <span class="math notranslate nohighlight">\(t(t_{LMT})\)</span>. Hence the time stamps <span class="math notranslate nohighlight">\(t_H\)</span> and <span class="math notranslate nohighlight">\(t_{LMT}\)</span> of the respective data points are different. Only at the end of a network execution are <span class="math notranslate nohighlight">\(t_H\)</span> and <span class="math notranslate nohighlight">\(t_{LMT}\)</span> synchronized and the wall clock time at the beginning of the execution is subtracted from both of them to reference the data points with respect to the beginning of the network execution. In addition, the power
readings <span class="math notranslate nohighlight">\(P(t_H)\)</span> are interpolated onto the set of time points <span class="math notranslate nohighlight">\(t_{LMT}\)</span>: <span class="math notranslate nohighlight">\(P(t_H) \rightarrow P(t_{LMT})\)</span>. As a result, both power and execution time are available as a function of algorithmic time steps: <span class="math notranslate nohighlight">\(P(t_{LMT}) \leftrightarrow P(t), t_{LMT}(t)\)</span>.</p>
<p>During each algorithmic time step, the embedded CPUs and neuro cores go through a number of different sequential but optional phases: 1. Spiking: During the first phase, neuro cores update their internal state and send and receive spike messages amongst them or the environment. No other message types than spike messages are allowed in the asynchronous mesh during this phase. In addition, the user has the possibility to execute a snip during the ‘spiking’ phase. 2. Pre-Learning Management: If the
‘learning’ phase is executed during the current time step, the user has the option to execute an optional ‘Pre-Learning management’ phase just before the ‘learning’ phase. During a ‘Pre-Learning management’ phase, the neuro cores enter a mode during which they are able to process management messages via the asynchrnous mesh while the user has the option to execute another snip during the ‘Pre-Learning management’ phase. 3. Learning: Every multiple of a predefined learning epoch, the neuro cores
update their synaptic state. During this phase, no spike or management message will be processed by the neuro cores. 4. Management: Independent of whether a ‘learning’ phase is executed during the current time step or not, another ‘management’ phase can be executed at the end or just after the ‘learning’ phase giving the user another possibility to execute a snip. After this ‘management’ phase, the embedded CPU will immediately proceed to the next algorithmic time step or will hand control back
to the host CPU. In case the host takes over, it may either reconfigure the system or probe any of the states within the neuro cores or the spike counters in the embedded CPUs. During each algorithmic time step, one of the embedded CPUs measures the time at the start (<span class="math notranslate nohighlight">\(t_{LMT}^S[i]\)</span>) and end (<span class="math notranslate nohighlight">\(t_{LMT}^E[i]\)</span>) of an algorithmic time step i just after the last optional ‘management’ phase. We call the time <span class="math notranslate nohighlight">\(t_{LMT}^S[i+1]-t_{LMT}^E[i]\)</span> the ‘host’ time during which the host may
interact with the system.</p>
<p>Because the sensor used to measure power consumption has a rather long time constant on the order of miliseconds, workloads should generally be repeated multiple times in order to allow the system to settle into a steady state for reliable energy characterizations. It should also be noted that probing of neuro core states at the end of an algorithmic time step slows down execution drastically. Hence probing should also be avoided to meaningfully characterize neuro core performance in isolation.</p>
<p>In this tutorial, we first define a couple of helper functions to set up a dummy neural network and functions to plot the results conveniently. Then we exercise EnergyProbes (which include ExecutionTimeProbes) in various scenarios subject to different workloads.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">nxsdk.arch.n2a.n2board</span> <span class="kn">import</span> <span class="n">N2Board</span>
<span class="kn">from</span> <span class="nn">nxsdk.api.enums.api_enums</span> <span class="kn">import</span> <span class="n">ProbeParameter</span>
<span class="kn">from</span> <span class="nn">nxsdk.graph.monitor.probes</span> <span class="kn">import</span> <span class="n">PerformanceProbeCondition</span>
</pre></div>
</div>
</div>
<div class="section" id="1.-SLURM-partition-selection">
<h2><span class="section-number">9.1. </span>1. SLURM partition selection<a class="headerlink" href="#1.-SLURM-partition-selection" title="Permalink to this headline">¶</a></h2>
<p>Choose a persistent SLURM parition/board for performance profiling to execute on same board for consistent results.</p>
<p><strong>Internal vlab:</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PARTITION&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nahuku32&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;BOARD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ncl-ghrd-01&quot;</span>
</pre></div>
</div>
</div>
<p><strong>External vlab:</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#os.environ[&#39;PARTITION&#39;] = &quot;nahuku08&quot;</span>
<span class="c1">#os.environ[&#39;BOARD&#39;] = &quot;ncl-ext-ghrd-03&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.-Creating-a-minimal-network-with-execution-time-and-energy-probes">
<h2><span class="section-number">9.2. </span>2. Creating a minimal network with execution time and energy probes<a class="headerlink" href="#2.-Creating-a-minimal-network-with-execution-time-and-energy-probes" title="Permalink to this headline">¶</a></h2>
<p>Both execution time probes and energy probes are generated via the N2Board object. Since the energy probe also requires the measurement of execution time it is actually a subclass of the execution time probe class and shares some of its interface. Thus if an energy probe is created a separate exeuction time probe is not required.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Creating an execution time probe</span>
<span class="n">board</span> <span class="o">=</span> <span class="n">N2Board</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numChips</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCores</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">initNumSynapses</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">etProbe</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span>
    <span class="n">probeType</span><span class="o">=</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">EXECUTION_TIME</span><span class="p">,</span>
    <span class="n">probeCondition</span><span class="o">=</span><span class="n">PerformanceProbeCondition</span><span class="p">(</span>
        <span class="n">tStart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">tEnd</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
        <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
        <span class="n">binSize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Creating an execution time probe</span>
<span class="n">board</span> <span class="o">=</span> <span class="n">N2Board</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">numChips</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCores</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">initNumSynapses</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">eProbe</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span>
    <span class="n">probeType</span><span class="o">=</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">ENERGY</span><span class="p">,</span>
    <span class="n">probeCondition</span><span class="o">=</span><span class="n">PerformanceProbeCondition</span><span class="p">(</span>
        <span class="n">tStart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">tEnd</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
        <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
        <span class="n">binSize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">board</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">board</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522113 queued and waiting for resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522113 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:46753
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 9.47s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.15s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 0.84ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103439.5695903/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.86s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.53ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 8.44ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 2.50ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.48ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 1.94s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.18s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 100000 timesteps......Done 19.62s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
</div>
<div class="section" id="3.-Sample-workload">
<h2><span class="section-number">9.3. </span>3. Sample workload<a class="headerlink" href="#3.-Sample-workload" title="Permalink to this headline">¶</a></h2>
<p>runNetwork(..) defines a scaleable dummy workload that is used throughout this tutorial to stress the HW system with networks of different sizes.</p>
<p>The network is not constructed to perform a meaningful computation but rather to produce a well defined activity pattern. - There are numCoresPerChip and numCompartmentsPerCore. The connectivity per compartment is configuarble by numAxonsPerCompartment and numSynPerAxon. The compartments in each neuro core only connect back to the same neuro core for simplicity. - Each neuron integrates a bias current at produces spikes at a regular interSpikeInterval for a certain runtime. - The bufferSize
control the size of the ExecutionTimeProbe buffer on the embedded CPU which will compete with snips for Lakemont memory in a general setting. The binSize determines how many execution times of consecutive time steps get averaged into the same time bin of the the execution time buffer.</p>
<p>The network is configured at the NxCore API level for the sole reason of having full control over how this network is distributed over neuro cores. Other than the high level explanation and parameterization above the specific implementation of the network is irrelevant for this tutorial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">runNetwork</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">binSize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">tEpoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">createDebugProbe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a scalable sample network, executes the network and returns energy, voltaga and spike probes.&quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="n">numCompartmentsPerCore</span><span class="o">*</span><span class="n">numAxonsPerCompartment</span> <span class="o">&lt;=</span> <span class="mi">4096</span>

    <span class="n">board</span> <span class="o">=</span> <span class="n">N2Board</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">numChips</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">numCores</span><span class="o">=</span><span class="p">[</span><span class="n">numCoresPerChip</span><span class="p">],</span>
                    <span class="n">initNumSynapses</span><span class="o">=</span><span class="p">[[</span><span class="n">numCompartmentsPerCore</span><span class="o">*</span><span class="n">numSynPerAxon</span><span class="p">]</span><span class="o">*</span><span class="n">numCoresPerChip</span><span class="p">])</span>

    <span class="n">vth</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">vth</span><span class="o">//</span><span class="n">interSpikeInterval</span><span class="p">)</span>

    <span class="c1"># Configure compartments on cores</span>
    <span class="k">for</span> <span class="n">core</span> <span class="ow">in</span> <span class="n">board</span><span class="o">.</span><span class="n">n2Chips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n2CoresAsList</span><span class="p">:</span>
        <span class="n">core</span><span class="o">.</span><span class="n">numUpdates</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">numUpdates</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">numCompartmentsPerCore</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">core</span><span class="o">.</span><span class="n">cxProfileCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
            <span class="n">decayV</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">bapAction</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">refractDelay</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">vthProfileCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">staticCfg</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">vth</span><span class="o">=</span><span class="n">vth</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">dendriteAccumCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">delayBits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numCompartmentsPerCore</span><span class="p">):</span>
            <span class="n">core</span><span class="o">.</span><span class="n">cxCfg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
                <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
                <span class="n">biasExp</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">core</span><span class="o">.</span><span class="n">cxMetaState</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">phase0</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">phase3</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Connect compartments on cores</span>
    <span class="k">for</span> <span class="n">core</span> <span class="ow">in</span> <span class="n">board</span><span class="o">.</span><span class="n">n2Chips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n2CoresAsList</span><span class="p">:</span>
        <span class="n">ptr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numCompartmentsPerCore</span><span class="p">):</span>
            <span class="c1"># Create output axon</span>
            <span class="n">core</span><span class="o">.</span><span class="n">createDiscreteAxon</span><span class="p">(</span>
                <span class="n">srcCxId</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                <span class="n">dstChipId</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">dstCoreId</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="n">dstSynMapId</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">tEpoch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span>

            <span class="c1"># Create input axon</span>
            <span class="n">synMapId</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">tEpoch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="n">synMapId</span><span class="p">]</span><span class="o">.</span><span class="n">synapsePtr</span><span class="o">=</span><span class="n">ptr</span>
            <span class="n">core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="n">synMapId</span><span class="p">]</span><span class="o">.</span><span class="n">synapseLen</span><span class="o">=</span><span class="n">numSynPerAxon</span>
            <span class="n">core</span><span class="o">.</span><span class="n">synapseMap</span><span class="p">[</span><span class="n">synMapId</span><span class="p">]</span><span class="o">.</span><span class="n">discreteMapEntry</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
            <span class="n">ptr</span><span class="o">+=</span><span class="n">numSynPerAxon</span>

            <span class="c1"># Create synapses</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">numSynPerAxon</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">numSynPerAxon</span><span class="p">)):</span>
                <span class="n">core</span><span class="o">.</span><span class="n">synapses</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">CIdx</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">Wgt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">LrnEn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">synFmtId</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Create synapse formats</span>
        <span class="n">core</span><span class="o">.</span><span class="n">synapseFmt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">numSynapses</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span> <span class="n">idxBits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">wgtBits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fanoutType</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">learningCfg</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Enable learning</span>
        <span class="k">if</span> <span class="n">tEpoch</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">core</span><span class="o">.</span><span class="n">stdpPreProfileCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">updateAlways</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">core</span><span class="o">.</span><span class="n">stdpCfg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">firstLearningIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">core</span><span class="o">.</span><span class="n">numUpdates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">numStdp</span><span class="o">=</span><span class="n">numAxonsPerCompartment</span><span class="p">)</span>
            <span class="n">core</span><span class="o">.</span><span class="n">timeState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">tepoch</span><span class="o">=</span><span class="n">tEpoch</span><span class="p">)</span>

    <span class="n">vProbe</span> <span class="o">=</span> <span class="n">sProbe</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">createDebugProbe</span><span class="p">:</span>
        <span class="n">vProbe</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">n2Chips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n2Cores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;v&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sProbe</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">board</span><span class="o">.</span><span class="n">n2Chips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n2Cores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cxState</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;spike&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Create energy probe</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="n">PerformanceProbeCondition</span><span class="p">(</span><span class="n">tStart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tEnd</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span> <span class="n">bufferSize</span><span class="o">=</span><span class="n">bufferSize</span><span class="p">,</span> <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span><span class="p">)</span>
    <span class="n">eProbe</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">ENERGY</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>

    <span class="c1"># Run network</span>
    <span class="n">board</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
    <span class="n">board</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="n">powerStats</span> <span class="o">=</span> <span class="n">board</span><span class="o">.</span><span class="n">energyTimeMonitor</span><span class="o">.</span><span class="n">powerProfileStats</span>

    <span class="k">return</span> <span class="n">eProbe</span><span class="p">,</span> <span class="n">vProbe</span><span class="p">,</span> <span class="n">sProbe</span><span class="p">,</span> <span class="n">powerStats</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="4.-Basics-of-probing-and-execution-time">
<h2><span class="section-number">9.4. </span>4. Basics of probing and execution time<a class="headerlink" href="#4.-Basics-of-probing-and-execution-time" title="Permalink to this headline">¶</a></h2>
<div class="section" id="4.1-Activity-of-a-single-neuron">
<h3><span class="section-number">9.4.1. </span>4.1 Activity of a single neuron<a class="headerlink" href="#4.1-Activity-of-a-single-neuron" title="Permalink to this headline">¶</a></h3>
<p>Below we demonstrate the operation of the dummy network by observing the membrane voltage and output spikes of a single neuron in the network whose dynamics is repeated multiple times across a chip.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eProbe</span><span class="p">,</span> <span class="n">vProbe</span><span class="p">,</span> <span class="n">sProbe</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">createDebugProbe</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:35757
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 0.17s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.11s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 2.10ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103451.485287/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.85s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.62ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 7.68ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 3.19ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.53ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.40s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.11s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 1000 timesteps........Done 8.67s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">vProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Membrane potential&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sProbe</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Spikes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time step&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5,0,&#39;Time step&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_14_1.png" src="../_images/jupyter_i_performance_profiling_14_1.png" />
</div>
</div>
<p>Each neuron integrates its bias current and spikes after 10 time steps.</p>
</div>
<div class="section" id="4.2-Execution-times">
<h3><span class="section-number">9.4.2. </span>4.2 Execution times<a class="headerlink" href="#4.2-Execution-times" title="Permalink to this headline">¶</a></h3>
<p>To illustrate execution time measurement, we first disable debug probes and execute the network without spiking activity but with synaptic plasticity enabled.</p>
<p>Note: No actual learning rule is configured in this sample workload. We only enable learning to see the effect on the various phases within a time step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eProbeWithProbes</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">tEpoch</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">createDebugProbe</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:38353
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 0.16s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 0.19s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.15s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103463.4606912/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.85s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.83ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 9.08ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 0.07s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.69ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.05s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 6.64ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 1000 timesteps........Done 8.51s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gorchard/pyenv/lib/python3.5/site-packages/numpy/core/fromnumeric.py:2957: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/gorchard/pyenv/lib/python3.5/site-packages/numpy/core/_methods.py:80: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">eProbeWithProbes</span><span class="o">.</span><span class="n">plotExecutionTime</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_18_0.png" src="../_images/jupyter_i_performance_profiling_18_0.png" />
</div>
</div>
<p>The diagram shows the execution times per time step of the various sequential phases within a time step of which only the spiking phase is mandatory: - Spiking: Duration of spiking phase - (Optional) PreLearnMgmt: Duration of optional management phase before learning phase (here disabled) - (Optional) Learning: Duration of learning phase. Since the learning epoch is set to 16, learning rules are executed every 16 time steps (although no actual learning rule is configured in this example). -
(Optional) Management: Duration of management at the end of each time step (here disabled) - Host: Duration of host phase when the embedded Lakemont CPU returns control back to the host (here disabled)</p>
<p>During the 100 time steps of the experiment, the Lakemont CPU controls time step advancement without any interaction from the host.</p>
</div>
<div class="section" id="4.3-Probing-state-impacts-execution-time">
<h3><span class="section-number">9.4.3. </span>4.3 Probing state impacts execution time<a class="headerlink" href="#4.3-Probing-state-impacts-execution-time" title="Permalink to this headline">¶</a></h3>
<p>When we turn on debug probes to read out membrane potentials or other states, the embedded Lakemont CPU periodically returns control to the host, which in turn evaluates all probes. However this increase in system observability comes at the cost of additional execution time.</p>
<p>Note: ProbeConditions allow to specify an initial time offset as well as a probe interval which determines how often probes get evaluated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eProbeWithoutProbes</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">createDebugProbe</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">eProbeWithProbes</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">createDebugProbe</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:37227
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 0.16s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.11s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 1.53ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103473.7208602/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.85s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.74ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 8.07ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 4.66ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.70ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.04s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 5.77ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 1000 timesteps........Done 8.19s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522119 queued and waiting for resources
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gorchard/pyenv/lib/python3.5/site-packages/numpy/core/fromnumeric.py:2957: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/home/gorchard/pyenv/lib/python3.5/site-packages/numpy/core/_methods.py:80: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522119 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:45881
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 19.20s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 3.17ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.16s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103502.4961944/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.85s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.68ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 8.20ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 3.05ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.58ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.41s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.11s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 1000 timesteps........Done 27.76s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">eProbeWithoutProbes</span><span class="o">.</span><span class="n">plotExecutionTime</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Execution times without state probes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">eProbeWithProbes</span><span class="o">.</span><span class="n">plotExecutionTime</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Execution times with state probes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5,1,&#39;Execution times with state probes&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_22_1.png" src="../_images/jupyter_i_performance_profiling_22_1.png" />
</div>
</div>
<p>Without state probes, the host phase duration is zero. However, with state probes, the total execution time per time step increases because of the additional host phase time. During the host phase, the Lakemont returns control back to the host, which evaluates all registered probes, reads state from neuro registers and finally returns control back to Lakemont.</p>
</div>
</div>
<div class="section" id="5.-Power-and-Energy-Profiling">
<h2><span class="section-number">9.5. </span>5. Power and Energy Profiling<a class="headerlink" href="#5.-Power-and-Energy-Profiling" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="5.1-Total-Power-Measurement">
<h2><span class="section-number">9.6. </span>5.1 Total Power Measurement<a class="headerlink" href="#5.1-Total-Power-Measurement" title="Permalink to this headline">¶</a></h2>
<p>When power probes are used, raw power measurements taken during a run are returned to the user and can be plotted as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">maxBufferSize</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">3</span>
<span class="n">binSize</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">runtime</span> <span class="o">=</span> <span class="n">maxBufferSize</span><span class="o">*</span><span class="n">binSize</span>
<span class="n">eProbe</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="n">runtime</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="n">maxBufferSize</span><span class="p">,</span>
    <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522121 queued and waiting for resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522121 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:35575
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 17.69s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 1.33ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.11s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103531.0100176/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.84s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.57ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 7.82ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 2.66ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.52ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.44s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.04s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 196608 timesteps......Done 26.16s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">eProbe</span><span class="o">.</span><span class="n">plotPower</span><span class="p">()</span>
<span class="c1">#plt.ylim(400, 800)</span>
<span class="n">avgVddPower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">eProbe</span><span class="o">.</span><span class="n">rawPowerVdd</span><span class="p">)</span>
<span class="n">avgVddmPower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">eProbe</span><span class="o">.</span><span class="n">rawPowerVddm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average VDD power: </span><span class="si">%d</span><span class="s2">mW&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">avgVddPower</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average VDDM power: </span><span class="si">%d</span><span class="s2">mW&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">avgVddmPower</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average VDD power: 840mW
Average VDDM power: 305mW
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_27_1.png" src="../_images/jupyter_i_performance_profiling_27_1.png" />
</div>
</div>
<p>The above diagram shows the raw power readings as a function of wall clock time througout network execution.</p>
<p>Each board supports to read out a number of different power components: - VDD: Mostly compute logic - VDDM: Mostly SRAMs - VDDA: Mostly LMT clock generation - VDDIO: Mostly FPIO/PIO interfaces</p>
<p>The power consumed by the system is recorded at the host level; independent from the embedded Lakemont CPUs. The power shown above is thus referenced against the time measured by the host. Only in the end are the two independent clocks of the Lakemont and host synchronized to determine the power or energy consumed in a particular time step.</p>
<p>Without any workloads executing on neuro cores, we find idle/background power levels of around VDD=3100mW and VDDM=5400mW for Nahuku32 and VDD=40mV, VDDM=70mW, VDDIO=5mW for Wolf Mountain. These power levels are mostly due to leakage in the system. Note: Nahuku can’t measure the the contributions for VDDIO and VDDA separately.</p>
<div class="section" id="5.2-Power-profile-of-fully-utilized-Loihi-chip">
<h3><span class="section-number">9.6.1. </span>5.2 Power profile of fully utilized Loihi chip<a class="headerlink" href="#5.2-Power-profile-of-fully-utilized-Loihi-chip" title="Permalink to this headline">¶</a></h3>
<p>While the system is active, it consumes power that is dependent on the level of activity within the neuro cores. In this second power measurement, we chose certain parameters for bufferSize and binSize. Their specific impact on execution will be discussed below. - The network has 128 active cores with 1024 neurons each to cause a significant enough workload. - The execution time buffer is set to roughly its maximum value that is still supported by the embedded Lakemont CPU memory. - The
execution time buffer bin size is set to 4, so the phase durations of 4 consecutive time steps are averaged. - Spiking is disabled by setting the inter spike interval to twice the runtime.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">maxBufferSize</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">3</span>
<span class="n">binSize</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">runtime</span> <span class="o">=</span> <span class="n">maxBufferSize</span><span class="o">*</span><span class="n">binSize</span>
<span class="n">eProbe</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="n">runtime</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="n">maxBufferSize</span><span class="p">,</span>
    <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522124 queued and waiting for resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522124 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:43391
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 14.07s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.16s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 7.23s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103559.5083156/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.85s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.58ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 7.88ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 1.98s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.53ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.21s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.02s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 12288 timesteps.......Done 31.55s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">eProbe</span><span class="o">.</span><span class="n">plotPower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa5a53fa278&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa5a53fa400&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa5a53fa550&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa5a53fa6a0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa5a53fa7f0&gt;,
 &lt;matplotlib.collections.LineCollection at 0x7fa5a53fa940&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_31_1.png" src="../_images/jupyter_i_performance_profiling_31_1.png" />
</div>
</div>
<p>Even before execution starts, the system consumes a certain level of background power. During execution the power level gradually rises and drops again. This power profile does not actually reflect the true power profile of the system due to transients and latencies in power sensor readout.</p>
<p>Each power components is computed from independent sensor readings for voltage and current. These sensors have transient time constants on the order of 10’s of milli seconds. As a result, fast changes in power on milli second time scales or below are not observable and are therefore averaged out. Therefore, the power level gradually increases, remains constant for most of the run and then decreases gradually for some time after execution finishes.</p>
</div>
<div class="section" id="5.3-Impact-of-bufferSize-and-binSize">
<h3><span class="section-number">9.6.2. </span>5.3 Impact of bufferSize and binSize<a class="headerlink" href="#5.3-Impact-of-bufferSize-and-binSize" title="Permalink to this headline">¶</a></h3>
<p>The execution time buffer stores the execution times of the various phases within a time step in the memory of the embedded Lakemont CPU at runtime. The binSize determines how many phase durations of the same kind are summed and stored in the same bin of the buffer. The bufferSize controlls the number of bins in the buffer.</p>
<p>The maximum size of the buffer depends on memory utilization on the Lakemont CPU by user-programs and -data. Here we use a maximum buffer size of at most 1024*3.</p>
<p>To illustrate the impact of bufferSize and binSize, we compare two runs with reduced bufferSize and reduced binSize against a reference run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Reference</span>
<span class="n">maxBufferSize</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">3</span>
<span class="n">binSize</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">numRepetitions</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">runtime</span> <span class="o">=</span> <span class="n">maxBufferSize</span><span class="o">*</span><span class="n">binSize</span><span class="o">*</span><span class="n">numRepetitions</span>
<span class="n">eProbe0</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="n">runtime</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="n">maxBufferSize</span><span class="p">,</span>
    <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span>
<span class="p">)</span>
<span class="c1"># Reduced bufferSize</span>
<span class="n">maxBufferSize</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1</span>
<span class="n">binSize</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">eProbe1</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="n">runtime</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="n">maxBufferSize</span><span class="p">,</span>
    <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span>
<span class="p">)</span>
<span class="c1"># Reduced binSize</span>
<span class="n">maxBufferSize</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">3</span>
<span class="n">binSize</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">eProbe2</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
    <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">numSynPerAxon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">interSpikeInterval</span><span class="o">=</span><span class="n">runtime</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
    <span class="n">bufferSize</span><span class="o">=</span><span class="n">maxBufferSize</span><span class="p">,</span>
    <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522126 queued and waiting for resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522126 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:42407
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 13.87s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.12s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 7.14s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103596.770019/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.84s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.96ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 7.50ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 1.98s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.58ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 4.86s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.52s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 393216 timesteps......Done 36.36s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522128 queued and waiting for resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522128 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:43265
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 14.46s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.13s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 7.04s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103639.0194438/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.84s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.61ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 7.52ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 1.97s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 0.71ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 4.89s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.57s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 393216 timesteps......Done 36.93s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522130 queued and waiting for resources
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">Connection is taking longer than usual.</span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">Boards might be busy or consider reasons below:</span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">1. If you are working on INRC Cloud, ensure setting SLURM=1.</span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">2. Run sinfo to check if all boards are down.</span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">3. Check squeue below for any unfinished jobs. Run scancel &lt;JOBID&gt; to cancel hung jobs.</span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">JOBID     NAME                          PARTITION TIME      NODELIST(REASON)    USER                </span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">2522130   nx_driver_server              nahuku32  0:00      (Resources)         gorchard            </span>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">2522129   nx_driver_server              loihi     0:34      ncl-ghrd-01         gorchard</span>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  srun: job 2522130 has been allocated resources
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.92:37675
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 55.84s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 7.30s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.25s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Config /etc/nx/pio.cfg
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Args chip=0 cpu=0 /home/gorchard/nxsdk-nxsdk/nxsdk/driver/compilers/../../../temp/1590103730.622618/launcher_chip0_lmt0.bin --chips=1 --remote-relay=0
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  Lakemont_driver...
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 7.85s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.63ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 7.98ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 2.02s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 1.31ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 16.51s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 2.45s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 393216 timesteps......Done 92.24s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">HST</span>:  chip=0 cpu=0 halted, status=0x0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">eProbe0</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">eProbe0</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">eProbe0</span><span class="o">.</span><span class="n">plotPower</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avgVddPower</span><span class="p">,</span> <span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avgVddmPower</span><span class="p">,</span> <span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;bufferSize=1024*3, binSize=8&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">eProbe1</span><span class="o">.</span><span class="n">plotPower</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avgVddPower</span><span class="p">,</span> <span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avgVddmPower</span><span class="p">,</span> <span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;bufferSize=1024*1, binSize=8&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">eProbe2</span><span class="o">.</span><span class="n">plotPower</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avgVddPower</span><span class="p">,</span> <span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">avgVddmPower</span><span class="p">,</span> <span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;bufferSize=1024*3, binSize=1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_35_0.png" src="../_images/jupyter_i_performance_profiling_35_0.png" />
</div>
</div>
<p><strong>[Top panel] Reference:</strong> Due to the long runtime, the execution time buffer needs to be transferred multiple times from Lakemont to host. This leads to alterations of high power active phases during which neuro cores execute and low power idle phases during which neuro cores are idle and the execution time buffer is transferred to the host. Dotted lines show the respective backgrond power levels of VDD and VDDM.</p>
<p>__[Middle panel] Reduced bufferSize (bufferSize=1024*1, binSize=8):__ - Duration of high power active phase is reduced because the execution time buffer on the Lakemont CPU fills up more quickly requiring a transfer to the host. - Duration of low power idle phase between active phases is also reduced because of the smaller buffer to be transferred. - As a result of the low power phase having similar duration as the sampling interval of the power sensor, a frequency beating pattern can occur
(here in the level of the minimum power level).</p>
<p>__[Bottom panel] Reduced binSize (bufferSize=1024*3, binSize=1):__ - Duration of the high power active phase is reduced because the phase duration of fewer time steps get accumulated in the same bin of the execution time buffer. - Duration of the lower power idle phase has not changed because the same-sized buffer is transferred from the Lakemont CPU to the host. - In this case, the high power active phase has similar duration as the sampling interval of the power sensor which results in a
frequency beating effect of the high power level.</p>
<p>This shows that when either or both of the bufferSize or binSize is too small a frequency beating effect in the power measurement can occur. Thus both values should be chosen large enough. Note that, when the workload per time step increases, the duration the time steps also increases.</p>
</div>
</div>
<div class="section" id="5.4-Setting-up-a-Power-Test">
<h2><span class="section-number">9.7. </span>5.4 Setting up a Power Test<a class="headerlink" href="#5.4-Setting-up-a-Power-Test" title="Permalink to this headline">¶</a></h2>
<p>The time constant of the power measurements is significantly longer than a typical Loihi timestep or phase duration, so only the average power for a workload can be measured in this way. Finer grained power measurements of individual workload components requires designing a workload that isolates this component.</p>
<p>For example, a particular algorithm may require a core to be reset. Power probes can report the average power of the algorithm, but not how much energy was consumed just by the reset itself. To isolate the reset power, we would write a test that just resets the core, without running the other algorithm steps.</p>
<p>However, a single reset would be too short in duration for the power to be accurately measured, so for power measurement we would repeatedly reset the core and measure the average power. At the scale of a single core, the power consumed by reset would still be very small compared to the overall system power (which in the case of Nahuku32 would include all Nahuku32 chips) and could therefore be lost in the power measurement noise. The solution is to replicate the workload across many cores/chips
and divide the result by the total number of copies.</p>
<p>In general, more accurate measurements can be obtained by repeating the workload, both by having multiple copies running simultaneously, and by having each repeat its computation multiple times.</p>
</div>
<div class="section" id="5.5-Components-of-Power-Consumption">
<h2><span class="section-number">9.8. </span>5.5 Components of Power Consumption<a class="headerlink" href="#5.5-Components-of-Power-Consumption" title="Permalink to this headline">¶</a></h2>
<p>Power consumption can be broken down into “static” (transistor leakage) and “dynamic” (switching) components. Power consumption can also be broken down by Loihi component: Lakemonts and Neurocores.</p>
<p>Lakemonts are always fully powered, so there is no way to reduce Lakemont static power consumption. However, power probes know how many Lakemonts a model uses and will report the static power for those Lakemonts.</p>
<p>Unlike Lakemonts, unused Neurocores can be partially powered down to reduce their static power consumption, and this is handled automatically by NxSDK. The power probes will also automatically remove any power consumed by unused/partially powered down cores from the detailed power measurement.</p>
<p>Lakemont dynamic power consists of clock power, and additional power consumed by code execution (when a Lakemont is not in a “waiting” state). NxSDK will only clock the Lakemonts which are in use, and will measure the percentage of time each clocked Lakemont is executing code. These measurements are used to determine how much dynamic power Lakemonts are consuming. Clock power can be significant, almost 1.5W in total for all 96 Lakemonts on a Nahuku32, and clocked Lakemonts continue to consume
clock power, even when not performing any computation (such as when waiting for the next Loihi phase to start).</p>
<p>Neurocore dynamic power depends entirely on computation being performed. If a Neurocore has finished its computation for the current phase and is waiting for the start of the next phase, it will not consume any dynamic power (the Neurocores are asynchronous, there is no clock).</p>
</div>
<div class="section" id="5.6-Reported-Breakdown-of-Power">
<h2><span class="section-number">9.9. </span>5.6 Reported Breakdown of Power<a class="headerlink" href="#5.6-Reported-Breakdown-of-Power" title="Permalink to this headline">¶</a></h2>
<p>When power probes are used, the shutdown sequence of the board is modified. Additional power measurements are taken after Neurocore computation completes, after the Lakemonts stop, and after the cores are powered down. These additional power measurements are used to compute the breakdown between Neurocore/Lakemont, and static/dynamic components of power consumption.</p>
<p>The power breakdown is therefore only available after disconnecting from the board.</p>
</div>
<div class="section" id="5.7-Power-Report-Format">
<h2><span class="section-number">9.10. </span>5.7 Power Report Format<a class="headerlink" href="#5.7-Power-Report-Format" title="Permalink to this headline">¶</a></h2>
<p>The different components of power consumption are reported as a dictionary accessible through <strong>board.energyTimeMonitor.powerProfileStats.power</strong></p>
<p>All power measurements are in units of mW.</p>
<p>The fields are: - <strong>total</strong>: The total power consumption of the system during the run including all used and unused components - <strong>idle</strong>: The total power consumption of the system after Neurocore and Lakemont execution has finished, but Lakemonts are still clocked - <strong>static</strong>: The total static power consumption of the system during the run - <strong>dynamic</strong>: The total dynamic power consumption of the system during the run - <strong>core</strong>: A dictionary holding breakdown of the Neurocore power
consumption - <strong>logic_static</strong>: Total leakage for logic in all used Neurocores - <strong>SRAM_static</strong>: Total leakage for memory in all used Neurocores - <strong>static</strong>: Total leakage of all used Neurocores - <strong>dynamic</strong>: Total dynamic power of all used Neurocores during the run - <strong>lakemont</strong>: A dictionary holding breakdown of the Lakemont power consumption - <strong>logic_static</strong>: Total leakage for logic in all used Lakemonts - <strong>SRAM_static</strong>: Total leakage for memory in all used Lakemonts - <strong>static</strong>:
Total leakage of all used Lakemonts - <strong>clock</strong>: Total clock power for all used Lakemonts - <strong>code</strong>: Additional power consumed by code execution across all Lakemonts - <strong>dynamic</strong>: Total dynamic power for all used Lakemonts</p>
</div>
<div class="section" id="5.8-Power-to-Energy">
<h2><span class="section-number">9.11. </span>5.8 Power to Energy<a class="headerlink" href="#5.8-Power-to-Energy" title="Permalink to this headline">¶</a></h2>
<p>Power can be converted to Average Energy Per Timestep by multiplying by the average timestep duration, which is accessible through <strong>board.energyTimeMonitor.powerProfileStats.timePerTimestep</strong>.</p>
<p>The timestep duration is in micro seconds (us), so the resulting energy measurement is in nano Joules (nJ)</p>
</div>
<div class="section" id="6.-Workload-scaling">
<h2><span class="section-number">9.12. </span>6. Workload scaling<a class="headerlink" href="#6.-Workload-scaling" title="Permalink to this headline">¶</a></h2>
<p>Here we will illustrate the dependence of workload size on power and execution time using the tools described in Section 5 above.</p>
<p>In order to vary the workload size, we define a helper function to create and run networks with different number of cores per chip and different number of neurons per core. For each run, we extract the neurocore dynamic power.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">sweepWorkloadSize</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span>
                      <span class="n">numAxonsPerNeuron</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numSynPerNeuron</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxBufferSize</span><span class="o">=</span><span class="mi">1024</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>
                      <span class="n">binSize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">numRepetitions</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>

    <span class="c1"># Turn off status output from NxDriver</span>
    <span class="kn">from</span> <span class="nn">nxsdk.logutils.nxlogging</span> <span class="kn">import</span> <span class="n">set_verbosity</span><span class="p">,</span> <span class="n">LoggingLevel</span>
    <span class="n">set_verbosity</span><span class="p">(</span><span class="n">LoggingLevel</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>

    <span class="c1"># Sweep number of cores per chip and number of neurons per core</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">runtime</span> <span class="o">=</span> <span class="n">maxBufferSize</span><span class="o">*</span><span class="n">binSize</span><span class="o">*</span><span class="n">numRepetitions</span>
    <span class="k">if</span> <span class="n">interSpikeInterval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">interSpikeInterval</span> <span class="o">=</span> <span class="n">runtime</span><span class="o">*</span><span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sweeping numCoresPerChip and numNeuronsPerCore...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    numCoresPerChip=</span><span class="si">{}</span><span class="s1"> in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">numCoresPerChip</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">numNeuronsPerCore</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;        numNeuronsPerCore=</span><span class="si">{}</span><span class="s1"> in </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">))</span>

            <span class="n">eProbe</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">powerStats</span> <span class="o">=</span> <span class="n">runNetwork</span><span class="p">(</span>
                <span class="n">numCoresPerChip</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">numCompartmentsPerCore</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
                <span class="n">numAxonsPerCompartment</span><span class="o">=</span><span class="n">numAxonsPerNeuron</span><span class="p">,</span>
                <span class="n">numSynPerAxon</span><span class="o">=</span><span class="n">numSynPerNeuron</span><span class="p">,</span>
                <span class="n">interSpikeInterval</span><span class="o">=</span><span class="n">interSpikeInterval</span><span class="p">,</span>
                <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">,</span>
                <span class="n">bufferSize</span><span class="o">=</span><span class="n">maxBufferSize</span><span class="p">,</span>
                <span class="n">binSize</span><span class="o">=</span><span class="n">binSize</span>
            <span class="p">)</span>

            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powerStats</span><span class="p">)</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="section" id="6.1-Power,-energy-and-time-to-solution-with-spikes-enabled">
<h3><span class="section-number">9.12.1. </span>6.1 Power, energy and time to solution with spikes enabled<a class="headerlink" href="#6.1-Power,-energy-and-time-to-solution-with-spikes-enabled" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">numCoresPerChip</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>
<span class="n">numNeuronsPerCore</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">768</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]</span>
<span class="n">powerStats_spikes</span> <span class="o">=</span> <span class="n">sweepWorkloadSize</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span>
    <span class="n">numAxonsPerNeuron</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sweeping numCoresPerChip and numNeuronsPerCore...
    numCoresPerChip=1 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=32 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=64 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=96 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=128 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    Processing timeseries... .
</pre></div></div>
</div>
</div>
<div class="section" id="6.2-Power,-energy-and-time-to-solution-without-spikes">
<h3><span class="section-number">9.12.2. </span>6.2 Power, energy and time to solution without spikes<a class="headerlink" href="#6.2-Power,-energy-and-time-to-solution-without-spikes" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">powerStats_noSpikes</span> <span class="o">=</span> <span class="n">sweepWorkloadSize</span><span class="p">(</span>
    <span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span>
    <span class="n">numAxonsPerNeuron</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">interSpikeInterval</span><span class="o">=</span><span class="mf">1e9</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sweeping numCoresPerChip and numNeuronsPerCore...
    numCoresPerChip=1 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=32 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=64 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=96 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    numCoresPerChip=128 in [1, 32, 64, 96, 128]
        numNeuronsPerCore=0 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=256 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=512 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=768 in [0, 256, 512, 768, 1024]
        numNeuronsPerCore=1024 in [0, 256, 512, 768, 1024]
    Processing timeseries... .
</pre></div></div>
</div>
</div>
<div class="section" id="6.3-Comparison-of-power,-energy-and-time-to-solution">
<h3><span class="section-number">9.12.3. </span>6.3 Comparison of power, energy and time to solution<a class="headerlink" href="#6.3-Comparison-of-power,-energy-and-time-to-solution" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronPerCore</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots data per run as a function of number of cores per chip.&quot;&quot;&quot;</span>

    <span class="n">ls</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ls</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;numCoresPerChip&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">power_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">stats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">statslist</span><span class="p">]</span> <span class="k">for</span> <span class="n">statslist</span> <span class="ow">in</span> <span class="n">powerStats_spikes</span><span class="p">])</span>
<span class="n">power_noSpikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">stats</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="s1">&#39;core&#39;</span><span class="p">][</span><span class="s1">&#39;dynamic&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">statslist</span><span class="p">]</span> <span class="k">for</span> <span class="n">statslist</span> <span class="ow">in</span> <span class="n">powerStats_noSpikes</span><span class="p">])</span>
<span class="n">time_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">stats</span><span class="o">.</span><span class="n">timePerTimestep</span> <span class="k">for</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">statslist</span><span class="p">]</span> <span class="k">for</span> <span class="n">statslist</span> <span class="ow">in</span> <span class="n">powerStats_spikes</span><span class="p">])</span>
<span class="n">time_noSpikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">stats</span><span class="o">.</span><span class="n">timePerTimestep</span> <span class="k">for</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">statslist</span><span class="p">]</span> <span class="k">for</span> <span class="n">statslist</span> <span class="ow">in</span> <span class="n">powerStats_noSpikes</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">energy_noSpikes</span> <span class="o">=</span> <span class="n">power_noSpikes</span><span class="o">*</span><span class="n">time_noSpikes</span>
<span class="n">energy_spikes</span> <span class="o">=</span> <span class="n">power_spikes</span><span class="o">*</span><span class="n">time_spikes</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span> <span class="n">power_noSpikes</span><span class="p">,</span> <span class="s1">&#39;Power (no spikes)&#39;</span><span class="p">,</span> <span class="s1">&#39;P ($mW$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span> <span class="n">power_spikes</span><span class="p">,</span> <span class="s1">&#39;Power (spikes)&#39;</span><span class="p">,</span> <span class="s1">&#39;P ($mW$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span> <span class="n">time_noSpikes</span><span class="p">,</span> <span class="s1">&#39;Execution time per time step (no spikes)&#39;</span><span class="p">,</span> <span class="s1">&#39;T ($\mu s$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span> <span class="n">time_spikes</span><span class="p">,</span> <span class="s1">&#39;Execution time per time step (spikes)&#39;</span><span class="p">,</span> <span class="s1">&#39;T ($\mu s$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span> <span class="n">energy_noSpikes</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;Energy per time step (no spikes)&#39;</span><span class="p">,</span> <span class="s1">&#39;E ($\mu J$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plotData</span><span class="p">(</span><span class="n">numCoresPerChip</span><span class="p">,</span> <span class="n">numNeuronsPerCore</span><span class="p">,</span> <span class="n">energy_spikes</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;Energy per time step (spikes)&#39;</span><span class="p">,</span> <span class="s1">&#39;E ($\mu J$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_i_performance_profiling_52_0.png" src="../_images/jupyter_i_performance_profiling_52_0.png" />
</div>
</div>
<p><strong>Observations</strong>: - Power depends on number of active cores - Execution time depends on number of neurons per core and spike traffic</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="j_soft_reset_core.html" class="btn btn-neutral float-right" title="10. Hard vs. soft membrane voltage reset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="h_reward_trace.html" class="btn btn-neutral float-left" title="8. Reward Trace" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>