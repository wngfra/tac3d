

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5. Neuronal homeostasis &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Learning with Rewards" href="f_rewards_learning.html" />
    <link rel="prev" title="4. Synaptic plasticity" href="d_synaptic_plasticity.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nxnet_tutorials.html">NxNet Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a_compartment_setup.html">1. Compartment, CompartmentPrototype and Probes Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="b_connecting_compartments.html">2. Connecting compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="c_stimulating_compartments.html">3. Stimulating compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="d_synaptic_plasticity.html">4. Synaptic plasticity</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">5. Neuronal homeostasis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Activity-range-homeostasis">5.1. Activity range homeostasis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exponential-decay-homeostasis">5.2. Exponential decay homeostasis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">5.3. Plot and analyze results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="f_rewards_learning.html">6. Learning with Rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_snip_for_threshold_modulation.html">7. SNIPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="h_reward_trace.html">8. Reward Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="i_performance_profiling.html">9. Performance profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_core.html">10. Hard vs. soft membrane voltage reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_net.html">11. Soft reset membrane voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="k_interactive_spike_sender_receiver.html">12. Interactive Spike Sender and Spike Receivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="l_snip_for_compartment_setup_with_NxNet_C.html">13. Setup Compartments with NxNet C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="m_independent_networks_in_same_run.html">14. Independent Networks in Same Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html">15. Stochastic Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#C.-Puttin-It-All-Together">16. C. Puttin It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#Modify-createWtaMotif1-to-Include-Detector-Neuron">17. Modify createWtaMotif1 to Include Detector Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="o_snip_for_reading_lakemont_spike_count.html">18. Read Lakemont Spike Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="p_composable_networks.html">19. Composable Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="q_connection_sharing.html">20. Connection Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html">21. Stubs and NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html#NetModules">22. NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="s_multicx_neuron_self_reward.html">23. Implementation of a multi-compartment neuron with self-reward feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="t_vMinExp_and_vMaxExp.html">24. vMinExp and vMaxExp Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html">25. Neurons vs Compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html#Multi-compartment-neurons">26. Multi-compartment neurons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nxcore_tutorials.html">NxCore Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Neuronal homeostasis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># INTEL CORPORATION CONFIDENTIAL AND PROPRIETARY</span>
<span class="c1">#</span>
<span class="c1"># Copyright © 2018-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">config</span> IPCompleter.greedy=True
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nxsdk.api.n2a</span> <span class="k">as</span> <span class="nn">nx</span>
</pre></div>
</div>
</div>
<div class="section" id="Neuronal-homeostasis">
<h1><span class="section-number">5. </span>Neuronal homeostasis<a class="headerlink" href="#Neuronal-homeostasis" title="Permalink to this headline">¶</a></h1>
<p>Neuronal homeostasis can be used to adapt the excitability of a neuron to different levels of input stimulus intensity. The Loihi neuron model supports a built-in homeostasis rule which we call <em>range homeostasis</em> whereby the membrane threshold <span class="math notranslate nohighlight">\(v^{(thMant)}\)</span> is updated according to the following rule:</p>
<div class="math notranslate nohighlight">
\[v^{(thMant)}(t) = v^{(thMant)}(t-T^{(epoch)}) + \beta \cdot \left( \max \left(a(t)-a^{(max)}, 0 \right) + \min \left(a(t)-a^{(min)}, 0 \right) \right)\]</div>
<p>Similarly to synaptic plasticity, the homeostasis rule is evalutated at the end of an epoch <span class="math notranslate nohighlight">\(T^{(epoch)}\)</span>. <span class="math notranslate nohighlight">\(a^{(min)}\)</span> and <span class="math notranslate nohighlight">\(a^{(max)}\)</span> define an activity range. As long as the activity of a compartment <span class="math notranslate nohighlight">\(a\)</span> remains within that range the membrane threshold does not change. If <span class="math notranslate nohighlight">\(a^{(max)}\)</span> is exceed, the threshold increases, while the threshold decreases when the activity drops below <span class="math notranslate nohighlight">\(a^{(min)}\)</span>. <span class="math notranslate nohighlight">\(\beta\)</span> is a gain parameter which controls how much deviation
outside of the activity range impact the membrance threshold.</p>
<p>Besides this built-in homeostasis rule, other mechanisms to adapt the excitability of a compartment can be implemented by constructing multi-compartment neurons which allows us to design more complex neural behaviors. As an example, we demonstrate the implementation of another homeostatic rule which we call ‘exponential-decay’ homeostasis which is governed by the following dynamics:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
v^{(th)} &amp; = &amp; v^{(th,0)} + \Delta v^{(th)} \\
\Delta v^{(th)} &amp; = &amp; \Delta v^{(th)} \cdot (1-\delta^{(th)}) + \beta \cdot s(t)
\end{eqnarray}\end{split}\]</div>
<p>Here the minimum membrane threshold is given by the baseline value <span class="math notranslate nohighlight">\(v^{(th,0)}\)</span>. Whenever the compartment spikes (<span class="math notranslate nohighlight">\(s(t)=1\)</span>), the adaptive part of the threshold <span class="math notranslate nohighlight">\(\Delta v^{(th)}\)</span> increases by and amount <span class="math notranslate nohighlight">\(\beta\)</span> and then decays exponentially with a time constant <span class="math notranslate nohighlight">\(\tau^{(th)}\)</span>. We show below how such an effective homeostatic behavior can be implemented with Loihi’s multi-compartment capabilities.</p>
<p>An illustration of the network used in this tutorial is shown below.</p>
<p><img alt="Homeostasis" src="../_images/jupyter_homeostasis.png" /></p>
<div class="section" id="Activity-range-homeostasis">
<h2><span class="section-number">5.1. </span>Activity range homeostasis<a class="headerlink" href="#Activity-range-homeostasis" title="Permalink to this headline">¶</a></h2>
<p>In this first tutorial, we demonstrate the configuration and dynamics of the built-in ‘range homeostasis’ mechanism to adapt the membrane threshold of a compartment as a function of its firing activity.</p>
<p>We set the target activity range to <span class="math notranslate nohighlight">\([a^{(min)}, a^{(max)}]=[20, 80]\)</span>. Within this activity range, the membrane threshold remains static. Above/below the threshold increases/decreases and thus the firing activity decreases/increases.</p>
<p>To drive the spiking activity of the compartment, we inject 4 successive spike trains with different spike frequencies.</p>
<div class="section" id="Generate-input-spikes-with-varying-intensity-in-4-intervals">
<h3><span class="section-number">5.1.1. </span>Generate input spikes with varying intensity in 4 intervals<a class="headerlink" href="#Generate-input-spikes-with-varying-intensity-in-4-intervals" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">genSpikeTimes</span><span class="p">():</span>
    <span class="n">spikeTimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">spikeTimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spikeTimes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">301</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">spikeTimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spikeTimes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">801</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    <span class="n">spikeTimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spikeTimes</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1301</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="mi">35</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">spikeTimes</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Setup-network-with-compartment-subject-to-range-homeostasis">
<h3><span class="section-number">5.1.2. </span>Setup network with compartment subject to range homeostasis<a class="headerlink" href="#Setup-network-with-compartment-subject-to-range-homeostasis" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">setupRangeHomeostasisNetwork</span><span class="p">():</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

    <span class="c1"># Create compartment</span>
    <span class="n">cxProto</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span>
        <span class="n">enableHomeostasis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">vThMant</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">12</span><span class="p">),</span>
        <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">12</span><span class="p">),</span>
        <span class="n">activityTimeConstant</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
        <span class="n">activityImpulse</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
        <span class="n">minActivity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">maxActivity</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
        <span class="n">homeostasisGain</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">tEpoch</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">cxProto</span><span class="p">)</span>

    <span class="c1"># Create and connect spike generator to compartment</span>
    <span class="n">spikeGenerator</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="n">numPorts</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spikeGenerator</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">genSpikeTimes</span><span class="p">())</span>
    <span class="n">connProto</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
                                       <span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">EXCITATORY</span><span class="p">)</span>
    <span class="n">spikeGenerator</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">connProto</span><span class="p">)</span>

    <span class="c1"># Define probes for current, activity and membrane threshold</span>
    <span class="n">probes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;aProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SOMA_STATE_ACTIVITY</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;vThProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SOMA_THRESHOLD_VOLTAGE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">net</span><span class="p">,</span> <span class="n">probes</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-network">
<h3><span class="section-number">5.1.3. </span>Run network<a class="headerlink" href="#Run-network" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">net</span><span class="p">,</span> <span class="n">probes</span> <span class="o">=</span> <span class="n">setupRangeHomeostasisNetwork</span><span class="p">()</span>

<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO:DRV:  SLURM is being run in background
INFO:DRV:  Connecting to 134.134.68.80:18861
INFO:DRV:  N2Driver: Running...
INFO:DRV:      Compiling synapses... Done (0.00s)
INFO:DRV:      Processing probes... Done (0.00s)
INFO:DRV:      Writing modified registers... Done (0.01s)
INFO:DRV:      Initializing... Done (0.01s)
INFO:DRV:      Preparing input... Done (0.02s)
INFO:DRV:      Executing... Done (0.19s)
INFO:DRV:      Processing timeSeries... Done (0.06s)
INFO:DRV:  N2Driver: Finished (0.30s)
</pre></div></div>
</div>
</div>
<div class="section" id="Plot-and-analyze-results">
<h3><span class="section-number">5.1.4. </span>Plot and analyze results<a class="headerlink" href="#Plot-and-analyze-results" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">intervalBoundaries</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">intervalBoundaries</span> <span class="o">=</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="mi">1800</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">probes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;COMPARTMENT_CURRENT&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">probes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;COMPARTMENT_VOLTAGE&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">probes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SPIKES&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">probes</span><span class="p">[</span><span class="s1">&#39;aProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ACTIVITY&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;aMin&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;aMax&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">probes</span><span class="p">[</span><span class="s1">&#39;vThProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;VOLTAGE_THRESHOLD&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># The COMPARTMENT_CURRENT diagram shows that we inject input spikes at 4 different frequencies. As a result, the ACTIVITY</span>
<span class="c1"># stays within then activity range first but then rises above and drops below the activity range. Whenever the ACTIVITY</span>
<span class="c1"># leaves the predefined activity range, VOLTAGE_THRESHOLD either increases or decreases.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_e_neuronal_homeostasis_12_0.png" src="../_images/jupyter_e_neuronal_homeostasis_12_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Exponential-decay-homeostasis">
<h2><span class="section-number">5.2. </span>Exponential decay homeostasis<a class="headerlink" href="#Exponential-decay-homeostasis" title="Permalink to this headline">¶</a></h2>
<p>In the second tutorial, we demonstrate the configuration and dynamics of the ‘exponential-decay’ homeostasis mechanism which is realized with the help of an auxiliary compartment.</p>
<p>In order to realize this homeostatic behavior, we create a multi-compartment neuron. The main compartment, integrates external input just as the compartment in the first tutorial. In addition, we connect this main compartment to an auxiliary child compartment with an inhibitory weight. Whenever the main compartment spikes, the membrane potential of the auxiliary compartment decreases and decays exponentially back to zero with a slow time constant on the scale of the desired threshold decay. We
then add the membrane potential of the auxiliary child compartment to the main compartment. Although the actual firing threshold of the main compartment does not change the effective difference between threshold and membrane potential increases for every spike of the main compartment and decays with the time constant of the threshold decay.</p>
<p>To demonstrate this mechanism we inject the same stimulus as in the previous tutorial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">setupExponentialDecayHomeostasisNetwork</span><span class="p">():</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

    <span class="c1"># Define neuron model parameters</span>
    <span class="n">baselineVth</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>         <span class="c1"># Scale factor from high level to finite precision model</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.9</span>            <span class="c1"># High level model threshold impulse</span>
    <span class="n">tauAux</span> <span class="o">=</span> <span class="mi">400</span>          <span class="c1"># Decay time constant of threshold decay and thus auxiliary compartment</span>
    <span class="n">tauMain</span> <span class="o">=</span> <span class="mi">20</span>          <span class="c1"># Decay time constant of main compartment</span>

    <span class="c1"># Create auxiliary compartment</span>
    <span class="n">auxiliaryCompartmentPrototype</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span>
        <span class="n">vThMant</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tauAux</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Create main compartment</span>
    <span class="n">mainCompartmentPrototype</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span>
        <span class="n">vThMant</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">baselineVth</span><span class="o">*</span><span class="n">scale</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">)),</span>
        <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tauMain</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">mainCompartmentPrototype</span><span class="o">.</span><span class="n">addDendrite</span><span class="p">(</span><span class="n">auxiliaryCompartmentPrototype</span><span class="p">,</span>
                                         <span class="n">nx</span><span class="o">.</span><span class="n">COMPARTMENT_JOIN_OPERATION</span><span class="o">.</span><span class="n">ADD</span><span class="p">)</span>

    <span class="n">np</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NeuronPrototype</span><span class="p">(</span><span class="n">mainCompartmentPrototype</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createNeuron</span><span class="p">(</span><span class="n">np</span><span class="p">)</span>

    <span class="c1"># Compute effective inhibitory weight from main to auxiliary compartment from threshold impulse and time constants</span>
    <span class="n">weightAux</span> <span class="o">=</span> <span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">tauAux</span> <span class="o">*</span> <span class="n">tauMain</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">tauAux</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">scale</span>
    <span class="c1"># Decompose auxiliary weight into mantissa and exponent</span>
    <span class="n">wgtAuxMant</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">weightAux</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">wgtAuxExp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">wgtAuxMant</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">wgtAuxExp</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">wgtAuxMant</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">wgtAuxMant</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># Connect main to auxiliary compartment</span>
    <span class="n">mainToAuxillaryConnectionProto</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span>
        <span class="n">weight</span><span class="o">=</span><span class="n">wgtAuxMant</span><span class="p">,</span>
        <span class="n">weightExponent</span><span class="o">=</span><span class="n">wgtAuxExp</span><span class="p">,</span>
        <span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">INHIBITORY</span><span class="p">,</span>
        <span class="n">compressionMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_COMPRESSION_MODE</span><span class="o">.</span><span class="n">DENSE</span><span class="p">)</span>
    <span class="n">n</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">dendrites</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prototype</span><span class="o">=</span><span class="n">mainToAuxillaryConnectionProto</span><span class="p">)</span>


    <span class="c1"># Create spike generator</span>
    <span class="n">spikeGenerator</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="n">numPorts</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Connect spike generator to main compartment</span>
    <span class="n">spikeConnProto</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span>
        <span class="n">weight</span><span class="o">=</span><span class="mi">98</span><span class="p">,</span>
        <span class="n">weightExponent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">signMode</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">SYNAPSE_SIGN_MODE</span><span class="o">.</span><span class="n">EXCITATORY</span><span class="p">)</span>
    <span class="n">spikeGenerator</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">soma</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">spikeConnProto</span><span class="p">)</span>

    <span class="c1"># Define input stimulus</span>
    <span class="n">spikeGenerator</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">genSpikeTimes</span><span class="p">())</span>


    <span class="c1"># Define probes for main compartment&#39;s current, voltage and spikes</span>
    <span class="n">mainProbes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">soma</span>
    <span class="n">mainProbes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mainProbes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mainProbes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Define probes for auxiliary compartment&#39;s current, voltage and spikes</span>
    <span class="n">auxProbes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">dendrites</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">auxProbes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">auxProbes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">auxProbes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">net</span><span class="p">,</span> <span class="n">mainProbes</span><span class="p">,</span> <span class="n">auxProbes</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3><span class="section-number">5.2.1. </span>Run network<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">net</span><span class="p">,</span> <span class="n">mainProbes</span><span class="p">,</span> <span class="n">auxProbes</span> <span class="o">=</span> <span class="n">setupExponentialDecayHomeostasisNetwork</span><span class="p">()</span>

<span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
INFO:DRV:  SLURM is being run in background
INFO:DRV:  Connecting to 134.134.68.80:18861
INFO:DRV:  N2Driver: Running...
INFO:DRV:      Compiling synapses... Done (0.00s)
INFO:DRV:      Processing probes... Done (0.00s)
INFO:DRV:      Writing modified registers... Done (0.01s)
INFO:DRV:      Initializing... Done (0.01s)
INFO:DRV:      Preparing input... Done (0.02s)
INFO:DRV:      Executing... Done (0.20s)
INFO:DRV:      Processing timeSeries... Done (0.06s)
INFO:DRV:  N2Driver: Finished (0.30s)
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2><span class="section-number">5.3. </span>Plot and analyze results<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Main compartment</span>
<span class="n">ax0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mainProbes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MAIN COMPARTMENT_CURRENT&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">mainProbes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MAIN COMPARTMENT_VOLTAGE&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">mainProbes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax0</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MAIN SPIKES&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="c1"># Auxiliary compartment</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">auxProbes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;AUXILIARY COMPARTMENT_CURRENT&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">auxProbes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;AUXILIARY COMPARTMENT_VOLTAGE&#39;</span><span class="p">)</span>
<span class="n">drawIntervalSeperators</span><span class="p">(</span><span class="n">intervalBoundaries</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># We stimulate the MAIN neuron with the same input spike train as before. As the MAIN compartment starts spiking, the</span>
<span class="c1"># COMPARTMENT_VOLTAGE of the AUXILIARY compartment drops. Because the MAIN compartment integrates the input from the</span>
<span class="c1"># AUXILIARY compartment, the firing rate of the main compartment decreases as seen in the second stimulus interval. As</span>
<span class="c1"># the stimulus intensity decreases in the third stimulus interval, the MAIN compartment is hardly excitable.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_e_neuronal_homeostasis_18_0.png" src="../_images/jupyter_e_neuronal_homeostasis_18_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="f_rewards_learning.html" class="btn btn-neutral float-right" title="6. Learning with Rewards" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="d_synaptic_plasticity.html" class="btn btn-neutral float-left" title="4. Synaptic plasticity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>