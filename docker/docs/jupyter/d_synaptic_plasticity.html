

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>4. Synaptic plasticity &mdash; NxSDK 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Neuronal homeostasis" href="e_neuronal_homeostasis.html" />
    <link rel="prev" title="3. Stimulating compartments" href="c_stimulating_compartments.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NxSDK
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introductory Material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxapi.html">NxAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxnet.html">NxNet API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nxcore.html">NxCore API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../composable.html">Composability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../embedded_execution_engine.html">Embedded Execution Engine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../nxnet_tutorials.html">NxNet Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="a_compartment_setup.html">1. Compartment, CompartmentPrototype and Probes Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="b_connecting_compartments.html">2. Connecting compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="c_stimulating_compartments.html">3. Stimulating compartments</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4. Synaptic plasticity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Generate-pre-and-post-synaptic-spikes-trains">4.1. Generate pre and post synaptic spikes trains</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Create-probes">4.2. Create probes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Compute-the-STDP-weight-change-as-a-function-of-post-and-pre-synaptic-spike-time-difference">4.3. Compute the STDP weight change as a function of post and pre synaptic spike time difference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Plot-results">4.4. Plot results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Configure-and-run-network">4.5. Configure and run network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Run-a-specific-network-and-analyze-results">4.6. Run a specific network and analyze results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="e_neuronal_homeostasis.html">5. Neuronal homeostasis</a></li>
<li class="toctree-l3"><a class="reference internal" href="f_rewards_learning.html">6. Learning with Rewards</a></li>
<li class="toctree-l3"><a class="reference internal" href="g_snip_for_threshold_modulation.html">7. SNIPs</a></li>
<li class="toctree-l3"><a class="reference internal" href="h_reward_trace.html">8. Reward Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="i_performance_profiling.html">9. Performance profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_core.html">10. Hard vs. soft membrane voltage reset</a></li>
<li class="toctree-l3"><a class="reference internal" href="j_soft_reset_net.html">11. Soft reset membrane voltage</a></li>
<li class="toctree-l3"><a class="reference internal" href="k_interactive_spike_sender_receiver.html">12. Interactive Spike Sender and Spike Receivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="l_snip_for_compartment_setup_with_NxNet_C.html">13. Setup Compartments with NxNet C API</a></li>
<li class="toctree-l3"><a class="reference internal" href="m_independent_networks_in_same_run.html">14. Independent Networks in Same Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html">15. Stochastic Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#C.-Puttin-It-All-Together">16. C. Puttin It All Together</a></li>
<li class="toctree-l3"><a class="reference internal" href="n_stochastic_networks.html#Modify-createWtaMotif1-to-Include-Detector-Neuron">17. Modify createWtaMotif1 to Include Detector Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="o_snip_for_reading_lakemont_spike_count.html">18. Read Lakemont Spike Count</a></li>
<li class="toctree-l3"><a class="reference internal" href="p_composable_networks.html">19. Composable Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="q_connection_sharing.html">20. Connection Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html">21. Stubs and NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="r_stubs_and_netmodules.html#NetModules">22. NetModules</a></li>
<li class="toctree-l3"><a class="reference internal" href="s_multicx_neuron_self_reward.html">23. Implementation of a multi-compartment neuron with self-reward feedback</a></li>
<li class="toctree-l3"><a class="reference internal" href="t_vMinExp_and_vMaxExp.html">24. vMinExp and vMaxExp Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html">25. Neurons vs Compartments</a></li>
<li class="toctree-l3"><a class="reference internal" href="u_join_op_in_multi_compartment_neuron.html#Multi-compartment-neurons">26. Multi-compartment neurons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../nxcore_tutorials.html">NxCore Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Nx SDK Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance-suite.html">NxSDK Performance Test Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">NxSDK Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NxSDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="../nxnet_jupyter_tutorials.html">NxNet Jupyter Tutorials</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>Synaptic plasticity</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Copyright © 2018-2021 Intel Corporation.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are Intel copyrighted</span>
<span class="c1"># materials, and your use of them is governed by the express</span>
<span class="c1"># license under which they were provided to you (License). Unless</span>
<span class="c1"># the License provides otherwise, you may not use, modify, copy,</span>
<span class="c1"># publish, distribute, disclose or transmit  this software or the</span>
<span class="c1"># related documents without Intel&#39;s prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># This software and the related documents are provided as is, with</span>
<span class="c1"># no express or implied warranties, other than those that are</span>
<span class="c1"># expressly stated in the License.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">config</span> IPCompleter.greedy=True
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nxsdk.api.n2a</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">from</span> <span class="nn">nxsdk.utils.plotutils</span> <span class="kn">import</span> <span class="n">plotRaster</span>
</pre></div>
</div>
</div>
<div class="section" id="Synaptic-plasticity">
<h1><span class="section-number">4. </span>Synaptic plasticity<a class="headerlink" href="#Synaptic-plasticity" title="Permalink to this headline">¶</a></h1>
<p>In order to demonstrate synaptic plasticity in a simple example, we study the weight dynamics of a synapse subject to an excitatory STDP learning rule. The network we configure consists of a spike generator that stimulates a learning-enabled synapse using an E-STDP learning rule. We then use another spike generator to independently drive a compartment that forms a post synaptic connection of the learning-enabled synpase. This test setup allows to control the pre and post synaptic spike times at
will independently and to study the induced weight dynamics. The network used in this tutorial is seen in the figure below.</p>
<p><img alt="01eb83ecc12443488793ce9148703ef2" src="../_images/jupyter_learning.png" /></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">setupNetwork</span><span class="p">(</span><span class="n">x1Imp</span><span class="p">,</span> <span class="n">y1Imp</span><span class="p">,</span> <span class="n">x1Tau</span><span class="p">,</span> <span class="n">y1Tau</span><span class="p">,</span> <span class="n">tEpoch</span><span class="p">):</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NxNet</span><span class="p">()</span>

    <span class="c1"># Create pre and post synaptic spike generators. Both spike generators give independent control over the pre and post</span>
    <span class="c1"># synaptic spike trains</span>
    <span class="n">spikeGenPre</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">spikeGenPost</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createSpikeGenProcess</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Create post synaptic compartment for the learning-enabled synapse. We only need the post synaptic compartment to</span>
    <span class="c1"># spike whenever it receives a spike from the post synaptic spike generator. Therefore, we set its threshold slightly</span>
    <span class="c1"># below the maximum weight and the current and voltage decay to the maximum. For the post synaptic traces to be</span>
    <span class="c1"># updated we need to enable the back propagation of action potential whenever the compartment spikes.</span>
    <span class="n">cxp</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">CompartmentPrototype</span><span class="p">(</span><span class="n">vThMant</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
                                  <span class="n">compartmentCurrentDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                  <span class="n">compartmentVoltageDecay</span><span class="o">=</span><span class="mi">4095</span><span class="p">,</span>
                                  <span class="n">enableSpikeBackprop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                  <span class="n">enableSpikeBackpropFromSelf</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cx</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createCompartment</span><span class="p">(</span><span class="n">cxp</span><span class="p">)</span>

    <span class="c1"># Connect post synaptic spike generator with the maximum weight to the compartment with a learning-disabled synapse.</span>
    <span class="n">connProtoNonLrn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
                                             <span class="n">enableLearning</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">connNonLrn</span> <span class="o">=</span> <span class="n">spikeGenPost</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">connProtoNonLrn</span><span class="p">)</span>

    <span class="c1"># Create an E-STDP learning rule used by the learning-enabled synapse and connect the pre synaptic spike generator.</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">createLearningRule</span><span class="p">(</span><span class="n">dw</span><span class="o">=</span><span class="s1">&#39;2^-2*x1*y0 - 2^-2*y1*x0&#39;</span><span class="p">,</span>
                                <span class="n">x1Impulse</span><span class="o">=</span><span class="n">x1Imp</span><span class="p">,</span>
                                <span class="n">x1TimeConstant</span><span class="o">=</span><span class="n">x1Tau</span><span class="p">,</span>
                                <span class="n">y1Impulse</span><span class="o">=</span><span class="n">y1Imp</span><span class="p">,</span>
                                <span class="n">y1TimeConstant</span><span class="o">=</span><span class="n">y1Tau</span><span class="p">,</span>
                                <span class="n">tEpoch</span><span class="o">=</span><span class="n">tEpoch</span><span class="p">)</span>
    <span class="n">connProtoLrn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ConnectionPrototype</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                          <span class="n">enableLearning</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                          <span class="n">learningRule</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
    <span class="n">connLrn</span> <span class="o">=</span> <span class="n">spikeGenPre</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">prototype</span><span class="o">=</span><span class="n">connProtoLrn</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">net</span><span class="p">,</span> <span class="n">spikeGenPre</span><span class="p">,</span> <span class="n">spikeGenPost</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">connNonLrn</span><span class="p">,</span> <span class="n">connLrn</span>
</pre></div>
</div>
</div>
<div class="section" id="Generate-pre-and-post-synaptic-spikes-trains">
<h2><span class="section-number">4.1. </span>Generate pre and post synaptic spikes trains<a class="headerlink" href="#Generate-pre-and-post-synaptic-spikes-trains" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">genRegularSpikeTimes</span><span class="p">(</span><span class="n">numSpikes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">spikeInterval</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a regular spiking spike train.&quot;&quot;&quot;</span>

    <span class="n">spikeTimesBase</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numSpikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">spikeInterval</span><span class="p">)</span>
    <span class="n">spikeTimes</span> <span class="o">=</span> <span class="n">spikeTimesBase</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">spikeTimes</span>

<span class="k">def</span> <span class="nf">genPoissonSpikeTimes</span><span class="p">(</span><span class="n">runTime</span><span class="p">,</span> <span class="n">spikingProbability</span><span class="p">,</span> <span class="n">tEpoch</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates an approximate Poisson spike train with a refractory period of tEpoch after each spike in order to avoid</span>
<span class="sd">    multiple spikes within the same learning epoch.&quot;&quot;&quot;</span>

    <span class="n">spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">runTime</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">refCtr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runTime</span><span class="p">):</span>
        <span class="n">spikes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">spikingProbability</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refCtr</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">spikes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">refCtr</span> <span class="o">=</span> <span class="n">tEpoch</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">refCtr</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">spikeTimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spikes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">spikeTimes</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Create-probes">
<h2><span class="section-number">4.2. </span>Create probes<a class="headerlink" href="#Create-probes" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">createProbes</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">connNonLrn</span><span class="p">,</span> <span class="n">connLrn</span><span class="p">):</span>
    <span class="n">probes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_CURRENT</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">COMPARTMENT_VOLTAGE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SPIKE</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;wProbeNonLrn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connNonLrn</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SYNAPSE_WEIGHT</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;wProbeLrn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connLrn</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">ProbeParameter</span><span class="o">.</span><span class="n">SYNAPSE_WEIGHT</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">probes</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Compute-the-STDP-weight-change-as-a-function-of-post-and-pre-synaptic-spike-time-difference">
<h2><span class="section-number">4.3. </span>Compute the STDP weight change as a function of post and pre synaptic spike time difference<a class="headerlink" href="#Compute-the-STDP-weight-change-as-a-function-of-post-and-pre-synaptic-spike-time-difference" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">extractStdpWeightChange</span><span class="p">(</span><span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">spikeTimesPost</span><span class="p">,</span> <span class="n">wProbeLrn</span><span class="p">):</span>
    <span class="c1"># Compute the weight changes for every weight change event</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wProbeLrn</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">wDiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">wDiff</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

    <span class="n">wDiffNonZero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">wDiff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">wDiff</span><span class="p">[</span><span class="n">wDiffNonZero</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Find the absolute time of every weight change event</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wProbeLrn</span><span class="o">.</span><span class="n">timeVector</span><span class="p">)</span>
    <span class="n">tNonZero</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">wDiffNonZero</span><span class="p">]</span>

    <span class="c1"># Compute the difference between post and pre synaptic spike time for every weight change event</span>
    <span class="n">spikeTimesPre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikeTimesPre</span><span class="p">)</span>
    <span class="n">spikeTimesPost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikeTimesPost</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dw</span><span class="p">)):</span>
        <span class="n">timeStamp</span> <span class="o">=</span> <span class="n">tNonZero</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">tPost</span> <span class="o">=</span> <span class="p">(</span><span class="n">spikeTimesPost</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spikeTimesPost</span> <span class="o">&lt;=</span> <span class="n">timeStamp</span><span class="p">)])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tPre</span> <span class="o">=</span> <span class="p">(</span><span class="n">spikeTimesPre</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spikeTimesPre</span> <span class="o">&lt;=</span> <span class="n">timeStamp</span><span class="p">)])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tPost</span><span class="o">-</span><span class="n">tPre</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dt</span><span class="p">,</span> <span class="n">dw</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plot-results">
<h2><span class="section-number">4.4. </span>Plot results<a class="headerlink" href="#Plot-results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plotNeuronDynamics</span><span class="p">(</span><span class="n">probes</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;uProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;COMPARTMENT_CURRENT&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;vProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;COMPARTMENT_VOLTAGE&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plotWeightChange</span><span class="p">(</span><span class="n">probes</span><span class="p">,</span> <span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">spikeTimesPost</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;wProbeNonLrn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WEIGHT (Learning disabled)&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sh</span> <span class="o">=</span> <span class="n">plotRaster</span><span class="p">([</span><span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">spikeTimesPost</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Pre spikes&#39;</span><span class="p">,</span> <span class="s1">&#39;Post spikes&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SPIKES&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;wProbeLrn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;WEIGHT (Learning enabled)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plotStdpDynamics</span><span class="p">(</span><span class="n">timeDelta</span><span class="p">,</span> <span class="n">weightDeltas</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">timeDelta</span><span class="p">,</span> <span class="n">weightDeltas</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;STDP weight change&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t_post - t_pre&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weight change&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Configure-and-run-network">
<h2><span class="section-number">4.5. </span>Configure and run network<a class="headerlink" href="#Configure-and-run-network" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">runNet</span><span class="p">(</span><span class="n">traceImp</span><span class="p">,</span> <span class="n">traceTau</span><span class="p">,</span> <span class="n">runTime</span><span class="p">,</span> <span class="n">spikingProbability</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tEpoch</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="c1"># Setup network, generate spike times and create probes</span>
    <span class="n">net</span><span class="p">,</span> <span class="n">spikeGenPre</span><span class="p">,</span> <span class="n">spikeGenPost</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">connNonLrn</span><span class="p">,</span> <span class="n">connLrn</span> <span class="o">=</span> <span class="n">setupNetwork</span><span class="p">(</span><span class="n">x1Imp</span><span class="o">=</span><span class="n">traceImp</span><span class="p">,</span>
                                                                           <span class="n">y1Imp</span><span class="o">=</span><span class="n">traceImp</span><span class="p">,</span>
                                                                           <span class="n">x1Tau</span><span class="o">=</span><span class="n">traceTau</span><span class="p">,</span>
                                                                           <span class="n">y1Tau</span><span class="o">=</span><span class="n">traceTau</span><span class="p">,</span>
                                                                           <span class="n">tEpoch</span><span class="o">=</span><span class="n">tEpoch</span><span class="p">)</span>
    <span class="n">spikeTimesPre</span> <span class="o">=</span> <span class="n">genPoissonSpikeTimes</span><span class="p">(</span><span class="n">runTime</span><span class="p">,</span> <span class="n">spikingProbability</span><span class="p">,</span> <span class="n">tEpoch</span><span class="p">)</span>
    <span class="n">spikeTimesPost</span> <span class="o">=</span> <span class="n">genPoissonSpikeTimes</span><span class="p">(</span><span class="n">runTime</span><span class="p">,</span> <span class="n">spikingProbability</span><span class="p">,</span> <span class="n">tEpoch</span><span class="p">)</span>
    <span class="n">spikeGenPre</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">spikeTimesPre</span><span class="p">)</span>
    <span class="n">spikeGenPost</span><span class="o">.</span><span class="n">addSpikes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">spikeTimesPost</span><span class="p">)</span>
    <span class="n">probes</span> <span class="o">=</span> <span class="n">createProbes</span><span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">connNonLrn</span><span class="p">,</span> <span class="n">connLrn</span><span class="p">)</span>

    <span class="c1"># Run network</span>
    <span class="n">net</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">runTime</span><span class="p">)</span>
    <span class="n">net</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="c1"># Extract weight change as a function of the difference between pre and post synaptic spike times</span>
    <span class="n">actSpikeTimesPost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">probes</span><span class="p">[</span><span class="s1">&#39;sProbe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dt</span><span class="p">,</span> <span class="n">dw</span> <span class="o">=</span> <span class="n">extractStdpWeightChange</span><span class="p">(</span><span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">actSpikeTimesPost</span><span class="p">,</span> <span class="n">probes</span><span class="p">[</span><span class="s1">&#39;wProbeLrn&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">probes</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">actSpikeTimesPost</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Run-a-specific-network-and-analyze-results">
<h2><span class="section-number">4.6. </span>Run a specific network and analyze results<a class="headerlink" href="#Run-a-specific-network-and-analyze-results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">probes</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">spikeTimesPost</span> <span class="o">=</span> <span class="n">runNet</span><span class="p">(</span><span class="n">traceImp</span><span class="o">=</span><span class="mi">127</span><span class="p">,</span>
                                                       <span class="n">traceTau</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                       <span class="n">runTime</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
                                                       <span class="n">spikingProbability</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span>
                                                       <span class="n">tEpoch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-black-intense-fg ansi-bold">WARNING</span>:<span class="ansi-blue-fg">DRV</span>:  <span class="ansi-yellow-fg">elementType would be deprecated in 0.9 in favor of messageSize, which provides more flexibility</span>
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  SLURM is being run in background
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Connecting to 134.134.68.81:41979
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Host server up..............Done 0.21s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Compiling Embedded snips....Done 0.17s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding axons/synapses.....Done 1.63ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Booting up..................Done 2.59s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Encoding probes.............Done 0.62ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Configuring registers.......Done 5.77ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring spikes.........Done 2.15ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Transferring probes.........Done 3.27ms
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Executing...................Done 0.14s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:      Processing timeseries.......Done 0.05s
<span class="ansi-black-intense-fg ansi-bold">INFO</span>:<span class="ansi-blue-fg">DRV</span>:  Executor: 2000 timesteps........Done 3.20s
</pre></div></div>
</div>
<p>The compartment current integrates inputs from the learning-disabled (large positive spikes) driver synapse as well as from the learning-enabled (small spikes) synapse whose weight changes over time. Both compartment current and voltage decay instantly after receiving an input.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plotNeuronDynamics</span><span class="p">(</span><span class="n">probes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_d_synaptic_plasticity_18_0.png" src="../_images/jupyter_d_synaptic_plasticity_18_0.png" />
</div>
</div>
<p>The weight of the learning-disabled driver synapse is constant. The weight of the learning-enabled synapses fluctuates over time, as a result of temporally close pre/post or post/pre spikes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plotWeightChange</span><span class="p">(</span><span class="n">probes</span><span class="p">,</span> <span class="n">spikeTimesPre</span><span class="p">,</span> <span class="n">spikeTimesPost</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_d_synaptic_plasticity_20_0.png" src="../_images/jupyter_d_synaptic_plasticity_20_0.png" />
</div>
</div>
<p>In the next figure we show the weight changes of the learning-enabled synapse as a function of the difference between post and pre synaptic spikes that preceed the weight change. The tuning curve shows the expected behavior for excitatory STDP learning: - Small causal spike events give rise to a large increase of the weight which decreases as the time between pre and post synaptic spike times increases. - Small anti-causal spike events give rise to large decreases of the weight which increases
as the time between post and pre synaptic spike times increases.</p>
<p>Note: If the weight saturates either at -256 or +255, the weight change in either direction will saturate at 0 regardless of spike time difference. Also note that if the learning epoch duration or spike frequnecy increases, the likelyhood of both pre and post synaptic spikes within an epoch increases. As a result, the induced weight change of both potentiating and depressive events can partially compensate each other which would lead to a clustering of points around the center away from the
expected E-STDP behavior.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plotStdpDynamics</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">dw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/jupyter_d_synaptic_plasticity_22_0.png" src="../_images/jupyter_d_synaptic_plasticity_22_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="e_neuronal_homeostasis.html" class="btn btn-neutral float-right" title="5. Neuronal homeostasis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="c_stimulating_compartments.html" class="btn btn-neutral float-left" title="3. Stimulating compartments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Intel Corporation.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>